# WebRTC Video Call Application

–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –≤–∏–¥–µ–æ–∑–≤–æ–Ω–∫–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ WebRTC —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Supabase –¥–ª—è —Å–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏–∏.

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

–¢—Ä–µ–±—É–µ—Ç—Å—è: Node.js & npm - [—É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å nvm](https://github.com/nvm-sh/nvm#installing-and-updating)

```sh
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
git clone <YOUR_GIT_URL>

# –ü–µ—Ä–µ—Ö–æ–¥ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd <YOUR_PROJECT_NAME>

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npm i

# –ó–∞–ø—É—Å–∫ dev —Å–µ—Ä–≤–µ—Ä–∞
npm run dev
```

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- Vite
- TypeScript
- React
- shadcn-ui
- Tailwind CSS
- WebRTC
- Supabase (Realtime –¥–ª—è —Å–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏–∏)

---

## üî¥ –í–ê–ñ–ù–û: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è TURN —Å–µ—Ä–≤–µ—Ä–æ–≤

### –ü—Ä–æ–±–ª–µ–º–∞ —Å –±–µ—Å–ø–ª–∞—Ç–Ω—ã–º–∏ TURN —Å–µ—Ä–≤–µ—Ä–∞–º–∏

**–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –ø—É–±–ª–∏—á–Ω—ã–µ TURN —Å–µ—Ä–≤–µ—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –ù–ï –ü–û–î–•–û–î–Ø–¢ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è!**

–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ TURN —Å–µ—Ä–≤–µ—Ä—ã –∏–º–µ—é—Ç —Å–µ—Ä—å–µ–∑–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
- üî¥ **–ù–µ–Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å**: —á–∞—Å—Ç–æ –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω—ã –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã
- üî¥ **–†–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏**: –º–æ–≥—É—Ç –±—ã—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã –≤ –≤–∞—à–µ–π —Å—Ç—Ä–∞–Ω–µ/—Ä–µ–≥–∏–æ–Ω–µ
- üî¥ **–ù–∏–∑–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å**: –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –ø—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å
- üî¥ **–ù–µ—Ç SLA**: –Ω–∏–∫–∞–∫–∏—Ö –≥–∞—Ä–∞–Ω—Ç–∏–π —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
- üî¥ **–õ–∏–º–∏—Ç—ã —Ç—Ä–∞—Ñ–∏–∫–∞**: –∂–µ—Å—Ç–∫–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ –æ–±—ä–µ–º –¥–∞–Ω–Ω—ã—Ö
- üî¥ **–ù–µ —Ä–∞–±–æ—Ç–∞—é—Ç —Å VPN**: —á–∞—Å—Ç–æ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è VPN-–ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏

### –ö–æ–≥–¥–∞ –Ω—É–∂–Ω—ã TURN —Å–µ—Ä–≤–µ—Ä—ã?

TURN —Å–µ—Ä–≤–µ—Ä—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö:

1. **VPN** - –æ–¥–∏–Ω –∏–ª–∏ –æ–±–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç VPN
2. **–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è —Å–µ—Ç—å** - —Å—Ç—Ä–æ–≥–∏–µ firewall –∏ NAT –ø—Ä–∞–≤–∏–ª–∞
3. **CGNAT** - –ø—Ä–æ–≤–∞–π–¥–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Carrier-grade NAT (–º–æ–±–∏–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç, –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ ISP)
4. **–°–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–π NAT** - —Å–∞–º—ã–π —Å—Ç—Ä–æ–≥–∏–π —Ç–∏–ø NAT, –±–ª–æ–∫–∏—Ä—É–µ—Ç P2P —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
5. **–†–∞–∑–Ω—ã–µ –∫–æ–Ω—Ç–∏–Ω–µ–Ω—Ç—ã** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Ä–∞–∑–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∞—Ö —Å —Ä–∞–∑–ª–∏—á–Ω–æ–π —Å–µ—Ç–µ–≤–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π

–í —ç—Ç–∏—Ö —Å–ª—É—á–∞—è—Ö –ø—Ä—è–º–æ–µ P2P —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ **–Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ**, –∏ –≤–µ—Å—å —Ç—Ä–∞—Ñ–∏–∫ –¥–æ–ª–∂–µ–Ω –∏–¥—Ç–∏ —á–µ—Ä–µ–∑ TURN relay —Å–µ—Ä–≤–µ—Ä.

---

## ‚úÖ –†–µ—à–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü–ª–∞—Ç–Ω—ã–µ –æ–±–ª–∞—á–Ω—ã–µ TURN —Å–µ—Ä–≤–∏—Å—ã (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

#### 1.1. Metered.ca (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö)

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Ç–∞—Ä–∏—Ñ: 50GB/–º–µ—Å—è—Ü
- –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Å–µ—Ç—å —Å–µ—Ä–≤–µ—Ä–æ–≤
- –ü—Ä–æ—Å—Ç–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- WebRTC-—Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞:**
1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è: [https://www.metered.ca/](https://www.metered.ca/)
2. –ü–æ–ª—É—á–∏—Ç–µ credentials –∏–∑ –¥–∞—à–±–æ—Ä–¥–∞
3. –û–±–Ω–æ–≤–∏—Ç–µ `src/components/VideoCall.tsx`:

```typescript
const peerConnection = new RTCPeerConnection({
  iceServers: [
    { urls: "stun:stun.l.google.com:19302" },
    {
      urls: [
        "turn:a.relay.metered.ca:80",
        "turn:a.relay.metered.ca:80?transport=tcp",
        "turn:a.relay.metered.ca:443",
        "turns:a.relay.metered.ca:443?transport=tcp"
      ],
      username: "YOUR_METERED_USERNAME",
      credential: "YOUR_METERED_CREDENTIAL"
    }
  ],
  iceCandidatePoolSize: 20,
  iceTransportPolicy: 'all',
  bundlePolicy: 'max-bundle',
  rtcpMuxPolicy: 'require',
});
```

**–¶–µ–Ω—ã:** –æ—Ç $0 (50GB) –¥–æ $99/–º–µ—Å—è—Ü (1TB)

#### 1.2. Xirsys

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ WebRTC
- –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Å–µ—Ç—å
- –•–æ—Ä–æ—à–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞:**
1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è: [https://xirsys.com/](https://xirsys.com/)
2. –°–æ–∑–¥–∞–π—Ç–µ –∫–∞–Ω–∞–ª –≤ –¥–∞—à–±–æ—Ä–¥–µ
3. –ü–æ–ª—É—á–∏—Ç–µ credentials
4. –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –æ–±–Ω–æ–≤–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

**–¶–µ–Ω—ã:** –æ—Ç $10/–º–µ—Å—è—Ü

#### 1.3. Twilio Network Traversal Service

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- Enterprise-—É—Ä–æ–≤–µ–Ω—å –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ Twilio —Å–µ—Ä–≤–∏—Å–∞–º–∏
- –û—Ç–ª–∏—á–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞:**
```javascript
// –ü–æ–ª—É—á–µ–Ω–∏–µ —ç—Ñ–µ–º–µ—Ä–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤ —á–µ—Ä–µ–∑ Twilio API
const response = await fetch('https://api.twilio.com/2010-04-01/Accounts/YOUR_ACCOUNT_SID/Tokens.json', {
  method: 'POST',
  headers: {
    'Authorization': 'Basic ' + btoa('YOUR_ACCOUNT_SID:YOUR_AUTH_TOKEN')
  }
});

const data = await response.json();
// –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ data.ice_servers –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ RTCPeerConnection
```

**–¶–µ–Ω—ã:** pay-as-you-go, ~$0.001 –∑–∞ –º–∏–Ω—É—Ç—É

#### 1.4. VideoSDK

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –≤–∏–¥–µ–æ
- TURN —Å–µ—Ä–≤–µ—Ä—ã –≤–∫–ª—é—á–µ–Ω—ã
- –ü—Ä–æ—Å—Ç–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞:**
1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è: [https://www.videosdk.live/](https://www.videosdk.live/)
2. –ü–æ–ª—É—á–∏—Ç–µ API key
3. –û–±–Ω–æ–≤–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

**–¶–µ–Ω—ã:** –æ—Ç –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ —Ç–∞—Ä–∏—Ñ–∞

---

### –í–∞—Ä–∏–∞–Ω—Ç 2: –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π coturn —Å–µ—Ä–≤–µ—Ä (–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å)

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å
- –ù–µ—Ç –ª–∏–º–∏—Ç–æ–≤ —Ç—Ä–∞—Ñ–∏–∫–∞
- –ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
- –û–¥–Ω–æ–∫—Ä–∞—Ç–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ VPS

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- VPS —Å –º–∏–Ω–∏–º—É–º 2GB RAM, 2 CPU cores
- Ubuntu 20.04+ –∏–ª–∏ Debian 11+
- –ü—É–±–ª–∏—á–Ω—ã–π IP –∞–¥—Ä–µ—Å
- –û—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã: 3478 (UDP/TCP), 5349 (UDP/TCP), 49152-65535 (UDP)

#### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ coturn –Ω–∞ Ubuntu

```bash
# 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ coturn
sudo apt update
sudo apt install coturn -y

# 2. –í–∫–ª—é—á–µ–Ω–∏–µ coturn
sudo nano /etc/default/coturn
# –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ: TURNSERVER_ENABLED=1

# 3. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
sudo nano /etc/turnserver.conf
```

**–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è `/etc/turnserver.conf`:**

```conf
# –ü—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–µ
listening-ip=0.0.0.0
listening-port=3478
tls-listening-port=5349

# –ü—É–±–ª–∏—á–Ω—ã–π IP –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
external-ip=YOUR_SERVER_PUBLIC_IP

# –î–∏–∞–ø–∞–∑–æ–Ω relay –ø–æ—Ä—Ç–æ–≤
min-port=49152
max-port=65535

# Realm (–¥–æ–º–µ–Ω –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
realm=yourdomain.com

# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
verbose
log-file=/var/log/turnserver.log

# –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
lt-cred-mech
user=username:password

# –î–ª—è –∑–∞—â–∏—Ç—ã –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ fingerprint
fingerprint

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
# userdb=/var/lib/turn/turndb

# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è (–ø—Ä–æ—Ç–∏–≤ DDoS)
max-bps=1000000
total-quota=100
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSL/TLS (–¥–ª—è –ø–æ—Ä—Ç–∞ 5349):**

```bash
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Let's Encrypt
sudo apt install certbot -y
sudo certbot certonly --standalone -d turn.yourdomain.com

# –£–∫–∞–∂–∏—Ç–µ –≤ /etc/turnserver.conf:
# cert=/etc/letsencrypt/live/turn.yourdomain.com/cert.pem
# pkey=/etc/letsencrypt/live/turn.yourdomain.com/privkey.pem
```

**–ó–∞–ø—É—Å–∫:**

```bash
sudo systemctl restart coturn
sudo systemctl enable coturn

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
sudo systemctl status coturn

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
sudo tail -f /var/log/turnserver.log
```

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ coturn:**

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–Ω–ª–∞–π–Ω —Ç–µ—Å—Ç: [https://webrtc.github.io/samples/src/content/peerconnection/trickle-ice/](https://webrtc.github.io/samples/src/content/peerconnection/trickle-ice/)

–ò–ª–∏ —Å –ø–æ–º–æ—â—å—é —É—Ç–∏–ª–∏—Ç—ã:
```bash
npm install -g turn-test
turn-test YOUR_SERVER_IP 3478 username password
```

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏:**

```typescript
const peerConnection = new RTCPeerConnection({
  iceServers: [
    { urls: "stun:stun.l.google.com:19302" },
    {
      urls: [
        "turn:YOUR_SERVER_IP:3478",
        "turn:YOUR_SERVER_IP:3478?transport=tcp",
        "turns:YOUR_SERVER_IP:5349",
        "turns:YOUR_SERVER_IP:5349?transport=tcp"
      ],
      username: "username",
      credential: "password"
    }
  ],
  iceCandidatePoolSize: 20,
  iceTransportPolicy: 'all',
  bundlePolicy: 'max-bundle',
  rtcpMuxPolicy: 'require',
});
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

1. **–û–±–∞ –≤ –æ–¥–Ω–æ–π —Å–µ—Ç–∏**
   - –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –ø—Ä—è–º–æ–µ P2P —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ (host candidates)
   - –¢–µ—Å—Ç: –æ—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –¥–≤—É—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö –≤ –æ–¥–Ω–æ–π Wi-Fi —Å–µ—Ç–∏

2. **–û–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞ VPN**
   - –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ TURN relay
   - –¢–µ—Å—Ç: –≤–∫–ª—é—á–∏—Ç–µ VPN –Ω–∞ –æ–¥–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª–∏: –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è "relay" candidates

3. **–û–±–∞ –∑–∞ VPN –∏–ª–∏ –º–æ–±–∏–ª—å–Ω—ã–º –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–æ–º**
   - –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ TURN relay
   - –¢–µ—Å—Ç: –æ–±–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å VPN –∏–ª–∏ –æ–¥–∏–Ω –Ω–∞ –º–æ–±–∏–ª—å–Ω–æ–º 4G/5G
   - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—é—â–∏–π TURN —Å–µ—Ä–≤–µ—Ä

4. **–†–∞–∑–Ω—ã–µ —Å—Ç—Ä–∞–Ω—ã/–∫–æ–Ω—Ç–∏–Ω–µ–Ω—Ç—ã**
   - –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∫–∞–∫ P2P, —Ç–∞–∫ –∏ relay
   - –¢–µ—Å—Ç: –ø–æ–ø—Ä–æ—Å–∏—Ç–µ –∫–æ–ª–ª–µ–≥—É/–¥—Ä—É–≥–∞ –∏–∑ –¥—Ä—É–≥–æ–π —Å—Ç—Ä–∞–Ω—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

**–û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:**

```
‚úÖ –•–æ—Ä–æ—à–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏:
- "TURN relay candidate gathered"
- "relay" –≤ candidate breakdown
- "Connection established successfully"

üî¥ –ü—Ä–æ–±–ª–µ–º–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏:
- "NO RELAY CANDIDATES GATHERED"
- "ICE connection failed"
- "All connectivity checks failed"
- –¢–æ–ª—å–∫–æ "host" –∏ "srflx" –∫–∞–Ω–¥–∏–¥–∞—Ç—ã –±–µ–∑ "relay"
```

**–¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ —Ä–µ—à–µ–Ω–∏—è:**

| –û—à–∏–±–∫–∞ | –ü—Ä–∏—á–∏–Ω–∞ | –†–µ—à–µ–Ω–∏–µ |
|--------|---------|---------|
| NO RELAY CANDIDATES | TURN —Å–µ—Ä–≤–µ—Ä—ã –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ credentials, —Å–º–µ–Ω–∏—Ç–µ –Ω–∞ –ø–ª–∞—Ç–Ω—ã–π —Å–µ—Ä–≤–∏—Å |
| ICE connection failed | –í—Å–µ –∫–∞–Ω–¥–∏–¥–∞—Ç—ã –æ—Ç–∫–ª–æ–Ω–µ–Ω—ã | –í–∫–ª—é—á–∏—Ç–µ TURN relay, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ firewall |
| Connection timeout | Signaling –ø—Ä–æ–±–ª–µ–º–∞ | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Supabase –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ |
| Works without VPN, fails with VPN | TURN –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ | –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–∞–¥–µ–∂–Ω—ã–π TURN —Å–µ—Ä–≤–∏—Å |

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ç–ª–∞–¥–∫–∞

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ª–æ–≥–∏—Ä—É–µ—Ç:
- –¢–∏–ø—ã —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö ICE –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤
- –ê–∫—Ç–∏–≤–Ω—ã–µ –ø–∞—Ä—ã –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤
- –¢–∏–ø —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (P2P/relay)
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É connection/ICE —Å–æ—Å—Ç–æ—è–Ω–∏–π

### –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

```javascript
// –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞:

// 1. –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ candidates
peerConnection.getStats(null).then(stats => {
  stats.forEach(report => {
    if (report.type === 'local-candidate') {
      console.log(report);
    }
  });
});

// 2. –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∞–∫—Ç–∏–≤–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
peerConnection.getStats(null).then(stats => {
  stats.forEach(report => {
    if (report.type === 'candidate-pair' && report.state === 'succeeded') {
      console.log('Active pair:', report);
    }
  });
});

// 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ TURN
peerConnection.getStats(null).then(stats => {
  stats.forEach(report => {
    if (report.type === 'candidate-pair' && report.state === 'succeeded') {
      console.log('Using relay?', 
        report.localCandidate?.candidateType === 'relay' || 
        report.remoteCandidateType === 'relay'
      );
    }
  });
});
```

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

1. **–ù–µ —Ö—Ä–∞–Ω–∏—Ç–µ credentials –≤ –∫–æ–¥–µ** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
   ```javascript
   const TURN_USERNAME = import.meta.env.VITE_TURN_USERNAME;
   const TURN_CREDENTIAL = import.meta.env.VITE_TURN_CREDENTIAL;
   ```

2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ credentials** - –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω –≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –∫–æ—Ä–æ—Ç–∫–æ–∂–∏–≤—É—â–∏–µ —Ç–æ–∫–µ–Ω—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

3. **–û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ TURN** - –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ IP whitelist –∏ rate limiting –Ω–∞ coturn —Å–µ—Ä–≤–µ—Ä–µ

4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è** - —Å–ª–µ–¥–∏—Ç–µ –∑–∞ —Ç—Ä–∞—Ñ–∏–∫–æ–º –∏ —Å—Ç–æ–∏–º–æ—Å—Ç—å—é

---

## üåç –í—ã–±–æ—Ä TURN –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º

| –†–µ–≥–∏–æ–Ω | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è | –ü—Ä–∏—á–∏–Ω–∞ |
|--------|--------------|---------|
| üá∑üá∫ –†–æ—Å—Å–∏—è | –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π coturn –Ω–∞ VPS | –ú–Ω–æ–≥–∏–µ –∑–∞—Ä—É–±–µ–∂–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã |
| üá™üá∫ –ï–≤—Ä–æ–ø–∞ | Metered.ca, Xirsys | –•–æ—Ä–æ—à–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å |
| üá∫üá∏ –°–®–ê | Twilio, Metered.ca | Enterprise –ø–æ–¥–¥–µ—Ä–∂–∫–∞ |
| üá®üá≥ –ö–∏—Ç–∞–π | –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π coturn | Great Firewall –±–ª–æ–∫–∏—Ä—É–µ—Ç –º–Ω–æ–≥–∏–µ —Å–µ—Ä–≤–∏—Å—ã |
| üåè –ê–∑–∏—è | VideoSDK, Metered.ca | –°–µ—Ä–≤–µ—Ä—ã –≤ —Ä–µ–≥–∏–æ–Ω–µ |

---

## üöÄ –î–µ–ø–ª–æ–π

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ TURN —Å–µ—Ä–≤–µ—Ä–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ:

‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –Ω–∞–¥–µ–∂–Ω—ã–π TURN —Å–µ—Ä–≤–∏—Å (–Ω–µ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –ø—É–±–ª–∏—á–Ω—ã–µ)  
‚úÖ Credentials —Ö—Ä–∞–Ω–∏—Ç–µ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è  
‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∏ –≤—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ (VPN, NAT, –º–æ–±–∏–ª—å–Ω—ã–π)  
‚úÖ –ù–∞—Å—Ç—Ä–æ–∏–ª–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è TURN  
‚úÖ –ü–æ–¥–≥–æ—Ç–æ–≤–∏–ª–∏ –ø–ª–∞–Ω –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏

---

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [WebRTC –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://webrtc.org/getting-started/overview)
- [–ü–æ–Ω–∏–º–∞–Ω–∏–µ ICE, STUN –∏ TURN](https://webrtc.org/getting-started/peer-connections)
- [coturn –ø—Ä–æ–µ–∫—Ç –Ω–∞ GitHub](https://github.com/coturn/coturn)
- [Metered.ca –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://www.metered.ca/docs)
- [Xirsys –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://docs.xirsys.com/)
- [Twilio Network Traversal](https://www.twilio.com/docs/stun-turn)

---

## ‚ùì FAQ

**Q: –ü–æ—á–µ–º—É –º–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–Ω–æ–≥–¥–∞, –∞ –∏–Ω–æ–≥–¥–∞ –Ω–µ—Ç?**  
A: –°–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ TURN —Å–µ—Ä–≤–µ—Ä—ã –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω—ã –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã. –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –Ω–∞ –ø–ª–∞—Ç–Ω—ã–π —Å–µ—Ä–≤–∏—Å.

**Q: –ù—É–∂–µ–Ω –ª–∏ TURN –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤ –æ–¥–Ω–æ–π —Å–µ—Ç–∏?**  
A: –ù–µ—Ç, –¥–ª—è –æ–¥–Ω–æ–π —Å–µ—Ç–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ STUN. –ù–æ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ –ª—É—á—à–µ –∏–º–µ—Ç—å TURN –∫–∞–∫ fallback.

**Q: –°–∫–æ–ª—å–∫–æ —Å—Ç–æ–∏—Ç TURN –¥–ª—è 1000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π?**  
A: –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∑–≤–æ–Ω–∫–æ–≤. ~100-200$/–º–µ—Å—è—Ü –¥–ª—è —Å—Ä–µ–¥–Ω–µ–π –Ω–∞–≥—Ä—É–∑–∫–∏ (Metered.ca). –ò–ª–∏ ~50$/–º–µ—Å—è—Ü –∑–∞ VPS –¥–ª—è —Å–≤–æ–µ–≥–æ coturn.

**Q: –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ TURN —Å–µ—Ä–≤–µ—Ä–æ–≤?**  
A: –î–∞! –î–æ–±–∞–≤—å—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ—Ä–≤–µ—Ä–æ–≤ –≤ –º–∞—Å—Å–∏–≤ `iceServers` –¥–ª—è —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏—è.

---

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

---

–°–¥–µ–ª–∞–Ω–æ —Å ‚ù§Ô∏è –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ–π WebRTC –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏
